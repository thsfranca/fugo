;; Comprehensive test of multi-pass macro expansion

;; Basic macro
(macro defn [name params body]
  (def ~name (fn ~params ~body)))

;; Meta-macro that creates other macros
(macro defmacro [name params body]
  (macro ~name ~params ~body))

;; Use meta-macro to create a new macro
(defmacro square [x] (* ~x ~x))
(defmacro double [y] (+ ~y ~y))

;; Use all the macros
(defn add [a b] (+ a b))
(square 4)
(double 3)